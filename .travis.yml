language: java
install: true
script: bash src/main/scripts/travis-build.bash
jdk:
- oraclejdk8
branches:
  except:
  - /\+travis[0-9]+$/
env:
  global:
  - ATOMIST_REPO_USER=travis-mvn-deploy
  - secure: U9vWVM4UwjJD72AsQ8avjk8nCX10QFo34FpYSa0n2geVs+XbzW+ZA9amrQnbauNKI0pa4CcJcGCI120+DU8LxjwldK9mWZGE9rYf6kQr/D5o0TC5GndFa2CEzql6qcAnshcETQolu4xXp7/aJIU2LnpBCjamFMOjx0rplY+bdu60N4YBQjGeBU+YYX37JFp0qsahOPRN1ajYhHk7oKMLNm7mnLLFYooM/XTUsmGHUBDudgln7Z9TCPJy2daOeMCEblPALoR/AcXlCN61xePOXTxREzvylCGPtvf4kn43CDjM1nxe2sjXoneGkT8v5JDpxDb9U6VT4MQNsZJZtHygdiUEQLVBy7LgoT+h9CeR2TgwQef85G2MZs9QKKbqIqm4YZfCT73LDs3kim17xd/Ps3qeg2QUZa7tYs6mjphcif5V5Ih9BKuQD6CkgTXGs1M42juzhB47hAWKkiYSSWvsyaBFlR9tPLDKN3XhunUuCDer/h+9956Do1Zz7yt9suP4fcmhHmG9b5gfsSx4eJ/MC9gcB1Ri4aPjsA9pQy2slWBos571YRTcUpKkKZy1I8xBTX2/8uE4zK7fBFrh8ynlA8rw2FCdnPCBCU5V8LwHm2AcfR/7eIMJgbGg9osk2feGw4Md0U7nYs+ysasnw34HaZxDOJRBlAGHXFQOjqj50lc=
  - ARTIFACTORY_USER=travis-mvn-deploy
  - secure: jA7UIgyttFR5qC+G9bivgFq6zty5Z/grkmHVyuLFNfT7DV1I2xHkWwUuwxQggMUT/mx9G7BcViuOHE0MvTzuni1z/pWPZUe7psD966NQzToHW/ut3KP2/3m707rn+nSPo9l/h8WuYlVUqbhsRB1zhR3ZYVfkrOALfsMNAE8jBuS42C3opiApmTgNqHx9H+dZaoWA3vWAY75oLw8D2Vp3bJL2qdluBDguxh0KaDzSwhVGJ9h/JyHMjk0ZTiMePagJwzyVN0hQqkxqpr4JKXnbI4PE8/pKWJvVH+gOwd5J68McRPnm8FRLPCRDzxKqPHWvkvU9oUtL7Tzk5UocM4MrECnzU+aNhYxohH+M1Yu5e2YPNXJhQ6+p6BKWwmZv1RKlYdXBcLsgoYVHwTWahczSUT9/ay0D2ugiKy0AA6Hu7cDbegQpiBCU6AKgUqMIlAj6CJtcLBqLE/qOXv2AcWbDNIR5p2QXQfTErV6Y8LR6IXDWKyPgUu36JICJNSjps6drUzCNFy8t1EYxzmtmDtQ3Nkyc0siw+p56N8g0OMECqAR0YdQ0nRVDRO5P7ShwjlmQCb14iSJz8nOWHEfI3ThcXZa9Jvk8oYvwsc6h+QFaqUmDEQIvhxLcBnTLn+VegyXDnr7HcYA4CxPfZj+6fmb5brgAtfGWJ9Nf/72v3chZ03o=
  - HOMEBREW_TAP=atomist/homebrew-tap
  - secure: h4NRlGqGoORe/Idtgg5/2UBmKhKIznXe8LjpRkN7cce2sWzEMm1fJ6li2iJ8f7bayuBtoeuW/bcd/QpG9t/l4ckNM/inUQFoLKQUqrvbqq1W2KDVnRRo6e8vssUVNVGL1wjxQM80IlQGEZEL+B34AV54FLQhXe8MeYmbAHt+ruKO6HC8zTqy0KB0pr+oi4/U51DRAxegCaFDxn0Vhu1B4dTyKyjMcswKt030DjT77jxnAgoJgMFd+w8QAqYlhk6MvVX/ZZ+CO43JBWt7nSMuiweegw7+XKkFMzX6T/CV4oimi5pc+XZLez4vlRsf5UoDzh5VM4Ut0dOGoKBI5VjFirmrqDk+97jI9yLjeVJafk3RVsst9hRiyiALIr27k4CqD+hnv8Nmk8Kk+Q28XxHib+5xL4h+207ixXiD69ZEK2QiyR65ZpjsRezCwdhNXdN0Es8j3Vfao5tZfJS8/73LzA3xSRLwOeloJbEJAo3Nxrm5tOjdbT4QmpK8g9dQwAHTB7uxIz4KznzdGwAmjXBFjP8xGGVl6CHGiq7pT9Xxu1juNc7aXM7+LpONN3oJGPUXoScseT/kWl2UHkbRzyFRiXD/QPy8lK9MVpUxQlDFboTrL1b0oaBrQ5rfmiVtXVzYHPi/9FPKZ3xZCpo9vCvZj7pHJioJMu0r4Ntwx2JUg6U=
notifications:
  email: false
  webhooks:
    on_success: always
    on_failure: always
    on_start: always
    urls:
    - https://webhook.atomist.com/travis
cache:
  directories:
  - $HOME/.m2
  - $HOME/.atomist
deploy:
  provider: releases
  api_key:
    secure: aqTpRPuCYcU2MfczTnkJ0zKgOjDkDfW/+7WYb12vcsvld0cru/GQgZ7NGehFT0TZiiAzgIJccgQi9ZJdM8gblUPyn9SDMq/bMRLF/llVorqEL+pwIjZmmKjjMfdHG5BgoKSMz4fz3KzpewMxML4nxTmSQM7SYYqUHywD+gunrYKntdAMh+oAoPdsTkKpY+U1XaFgnNFF0OBiB6I4thZKfvlf8kTfWRuj+Ye72E/L+/JSYo4EtVqQ4u+nPfTF8GFwm21DIq4m6VzOjc8fFTS4H0dxVFEvP+xXu6WubXlvddxfyaACLpaMbIh7pJkYnmCo/X/gnfpD0+hTaEDFFEusUn1EHEOYom8xEj9KTvWgr3zvtjOHX/KIkfYjbFwI0i/fqg9pCx/jddgdL6WYgw17laYLf8Brxn1Bwd9Fp/Oe8AT0DISIxDfc5MgCsoH1InXI0QOVJ81lEQNyVYUUoNMY6L5N6ZMfN7+f2b9m2ANIJfL9c0xrAZ+gXiglnD4z0XJxW8kLt50JnsjFD+neF1s5/rBhnR/VNl3suADdY6W3R9xQ+dh9w7cPKyE6sFFaZdU3Tc9FE3ksrAMUam3Kl4u7WDA7bJ5HQ5QwRMqmjfKfx7BXQC6HrLgyM4ezRTtV/Mzl3rstggr/PYLe+6w+oqZmTO269C3nErDhtghJF69Mzms=
  file:
  - target/rug-cli-$TRAVIS_TAG-bin.tar.gz
  - target/rug-cli-$TRAVIS_TAG-bin.zip
  skip_cleanup: true
  on:
    tags: true
    condition: $TRAVIS_TAG =~ ^[0-9]+\.[0-9]+\.[0-9]+$
after_deploy:
- bash src/main/scripts/update-brew.bash $HOMEBREW_TAP $GITHUB_TOKEN
- bash src/main/scripts/update-brew.bash atomisthq/s3-images $GITHUB_TOKEN images/Formula
